<!doctype html>
<html lang="en-us">
  <head>
    <title>Raspberry Pi 4 Dev Server // Jeremy Morgan :: Tech Blog</title>
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.65.0-DEV" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Jeremy Morgan" />
    <meta name="description" content="In this tutorial, I will show you how to set up a Raspberry Pi 4 as a development (or testing) server. You can use this as a place to push your code and test it in a web browser. For the demo, I&#39;ll use a React application, but with a few modifications, you can build just about anything with it." />
    <link rel="stylesheet" href="https://jeremymorgan.github.io/css/main.min.576881e38f90640557131c03ef7ef2d40091d835c298c6ba74795b3f28000236.css" />

    
    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://jeremymorgan.github.io/baseimages/jeremy-morgan-og.jpg"/>

<meta name="twitter:title" content="Raspberry Pi 4 Dev Server"/>
<meta name="twitter:description" content="In this tutorial, I will show you how to set up a Raspberry Pi 4 as a development (or testing) server. You can use this as a place to push your code and test it in a web browser. For the demo, I&#39;ll use a React application, but with a few modifications, you can build just about anything with it."/>

    <meta property="og:title" content="Raspberry Pi 4 Dev Server" />
<meta property="og:description" content="In this tutorial, I will show you how to set up a Raspberry Pi 4 as a development (or testing) server. You can use this as a place to push your code and test it in a web browser. For the demo, I&#39;ll use a React application, but with a few modifications, you can build just about anything with it." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jeremymorgan.github.io/tutorials/raspberry-pi/raspberry-pi-4-dev-server/" />
<meta property="og:image" content="https://jeremymorgan.github.io/baseimages/jeremy-morgan-og.jpg"/>
<meta property="article:published_time" content="2020-02-02T10:44:03-08:00" />
<meta property="article:modified_time" content="2020-02-02T10:44:03-08:00" />


  </head>
  <body>
    <header class="app-header">
      <a href="https://jeremymorgan.github.io/"><img class="app-header-avatar" src="/baseimages/jeremy-morgan.jpg" alt="Jeremy Morgan" /></a>
      <h1>Jeremy Morgan</h1>
      <p>Mostly Coherent Ramblings of a Silicon Forest Software Developer</p>
      <div class="app-header-social">
        
          <a target="_blank" href="https://www.twitter.com/JeremyCMorgan" rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter">
  <title>twitter</title>
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
</svg></a>
        
          <a target="_blank" href="https://www.youtube.com/jeremymorgan" rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-youtube">
  <title>youtube</title>
  <path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon>
</svg></a>
        
          <a target="_blank" href="https://github.com/JeremyMorgan" rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg></a>
        
          <a target="_blank" href="https://www.linkedin.com/in/jeremycmorgan" rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-linkedin">
  <title>linkedin</title>
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle>
</svg></a>
        
      </div>
      <div class="links">
        <ul>
          <li><a href="https://jeremymorgan.github.io/">Home</a></li>
          <li><a href="/blog">Blog Articles</a></li>
          <li><a href="/tutorials">Tutorials</a></li>
          <li><a href="/tutorials">Courses</a></li>  
          <li><a href="https://www.pluralsight.com/resource-center/podcasts">Podcast</a>        
        </ul>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Raspberry Pi 4 Dev Server</h1>
      <div class="post-meta">
        <div>
         <em>Author: <a href="https://www.twitter.com/JeremyCMorgan">Jeremy Morgan</a></em>
        </div>
        <div>
          Published: <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Feb 2, 2020
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          9 min read
        </div></div>
    </header>
    <div class="post-content">
      <p>In this tutorial, I will show you how to set up a Raspberry Pi 4 as a development (or testing) server. You can use this as a place to push your code and test it in a web browser. For the demo, I&rsquo;ll use a React application, but with a few modifications, you can build just about anything with it.</p>
<p>For this project, I&rsquo;m using a <a href="http://bit.ly/CanakitRaspberryPi4">Canakit Raspberry Pi 4 Complete Kit</a>. This gives you everything you need to get going, including a case, power supply, and SD Card.</p>
<p><img src="/images/raspberry-pi-4-dev-server/raspberry-pi-4-dev-server-1.jpg" alt="Raspberry Pi 4 Development Server"></p>
<h3 id="why-bother">Why Bother?</h3>
<p>A solid development environment is important. You need a place where you can look at your application to make sure it&rsquo;s running fine. Many times folks do this on their local machine. It&rsquo;s better to test on a separate machine from what you&rsquo;re working on. This way, you can catch things like dependency and configuration changes.</p>
<p>This development/testing server has the following advantages:</p>
<ul>
<li>A configuration and environment that matches production (if you have a Linux host)</li>
<li>Build code on any machine push it to a centralized location</li>
<li>Continuous Integration - Push and refresh in your browser</li>
</ul>
<p>Ideally, you can set up a workflow that looks like this:
<!-- raw HTML omitted -->
<img src="/images/raspberry-pi-4-dev-server/raspberry-pi-4-dev-server-2.jpg" alt="Raspberry Pi 4 Development Server"></p>
<ol>
<li>Develop your code locally and commit it.</li>
<li>Push to development and test it out</li>
<li>Approve changes, push it live</li>
</ol>
<p>This enables a great workflow where you can make changes and edits, commit, then push them and refresh your browser. You can then develop your code from any machine on the network that has git. Once you&rsquo;re satisfied with the changes, you can copy the artifacts to production. In fact, you can integrate production pushes into this workflow to make it all automatic.</p>
<h3 id="setting-up-the-pi-as-a-server">Setting up the Pi as a Server</h3>
<p><img src="/images/raspberry-pi-4-dev-server/raspberry-pi-4-dev-server-3.jpg" alt="Raspberry Pi 4 Development Server"></p>
<p>For this project, I&rsquo;m using the full <a href="http://bit.ly/CanakitRaspberryPi4">Canakit Raspberry Pi kit</a>. It comes with everything you need. I won&rsquo;t go into setting this up in this article, but I should note that I&rsquo;m using the <a href="http://bit.ly/UbuntuRaspberryPi">Ubuntu Server image</a> for this project, and recommend you do the same.</p>
<p>I used my <a href="https://twitter.com/JeremyCMorgan/status/1216767569299853312">Pinebook pro</a> to burn the image to a card, but you can do this in Windows or with a Mac if you need to.</p>
<p><a href="http://bit.ly/SetupPi54">Here&rsquo;s a good guide</a> for setting up one of these kits.</p>
<p>We will set this up as a development/test server and use GIT to communicate with it. So here is what we&rsquo;ll do:</p>
<ul>
<li>Set up Git for Publishing</li>
<li>Install Nginx</li>
<li>Install NPM</li>
<li>Create deployment from a repo on your machine to the Raspberry Pi web server in a single step.</li>
</ul>
<p>When we&rsquo;re done, we can change our React application and push the changes to the Pi to view them as a web page.</p>
<h3 id="1-set-up-git-for-publishing">1. Set up Git for Publishing</h3>
<p><strong>Location: On Raspberry Pi</strong></p>
<p>First we need to install Git.</p>
<pre><code>sudo apt install git
</code></pre><p>Now we need to git shell to /etc/shells</p>
<pre><code>which git-shell
</code></pre><p>and we will add that output to /etc/shells</p>
<p><img src="/images/raspberry-pi-4-dev-server/raspberry-pi-4-dev-server-4.jpg" alt="Raspberry Pi 4 Development Server"></p>
<p>Now we want to set up a git user that doesn&rsquo;t have the cool permissions that your account does.</p>
<pre><code>sudo adduser --disabled-password git
</code></pre><p>Switch to the git user</p>
<pre><code>sudo su git
</code></pre><p>Change to the git users home</p>
<pre><code>cd ~
</code></pre><p>Make a directory for ssh files</p>
<pre><code>mkdir ~/.ssh &amp;&amp; chmod 700 ~/.ssh
</code></pre><p>We&rsquo;ll create our authorized_keys file</p>
<pre><code>touch ~/.ssh/authorized_keys &amp;&amp; chmod 600 ~/.ssh/authorized_keys
</code></pre><p>Now you can add the public keys of any machine you&rsquo;d like to access the server by adding them to:</p>
<pre><code>/home/git/.ssh/authorized_keys
</code></pre><p>Then we&rsquo;ll set the git users&rsquo; shell to git-shell</p>
<pre><code>sudo chsh git -s $(which git-shell)
</code></pre><p>Create a folder for our www files that we&rsquo;ll be serving later:</p>
<pre><code>mkdir ~/www
</code></pre><h3 id="2-create-our-project-folder">2. Create Our Project Folder</h3>
<p><strong>Location: On Raspberry Pi</strong></p>
<p>This is a remote repository set up so we can work on the project on any other machine, then push it to the Raspberry Pi.</p>
<pre><code>cd ~
mkdir /home/git/react-hello-world.git
</code></pre><p>Now, let&rsquo;s initiate it:</p>
<pre><code>cd react-hello-world.git &amp;&amp; git init --bare
</code></pre><p>Let&rsquo;s go back to our machine and test it out.</p>
<p>On your developer machine, type in:</p>
<pre><code>git clone git@[your IP address]:react-hello-world . 
</code></pre><p>You should be able to clone it your local machine.</p>
<p><img src="/images/raspberry-pi-4-dev-server/raspberry-pi-4-dev-server-5.jpg" alt="Raspberry Pi 4 Development Server"></p>
<p>If this works, we&rsquo;ll go back to the Raspberry Pi.</p>
<h3 id="3-install-nginx">3. Install Nginx</h3>
<p><strong>Location: On Raspberry Pi</strong></p>
<p>Next, we will install Nginx on our Raspberry pi and use it to serve web pages.</p>
<p>In this tutorial, we will set it up for a single project, so we&rsquo;ll be using a single www directory. However, if you have multiple projects, you want to break them into folders.</p>
<pre><code>sudo apt install Nginx
</code></pre><p>This will install Nginx.</p>
<p>You may need to add a firewall exception to ufw. You can list the available profiles by typing in:</p>
<pre><code>sudo ufw app list
</code></pre><p><img src="/images/raspberry-pi-4-dev-server/raspberry-pi-4-dev-server-6.jpg" alt="Raspberry Pi 4 Development Server"></p>
<p>You can add an exception with:</p>
<pre><code>sudo ufw allow 'Nginx HTTP'
</code></pre><p>Now when you bring up the IP in the web browser, you will see the Nginx welcome page.</p>
<p><img src="/images/raspberry-pi-4-dev-server/raspberry-pi-4-dev-server-7.jpg" alt="Raspberry Pi 4 Development Server"></p>
<p>Now you have an Nginx server up and running.</p>
<h3 id="4-configure-nginx">4. Configure Nginx</h3>
<p><strong>Location: On Raspberry Pi</strong></p>
<p>Next, we will change the Nginx config.</p>
<p>Make a copy of the default config in your home folder as a backup:</p>
<pre><code>sudo cp /etc/Nginx/sites-available/default ~
</code></pre><p>Edit the conf file and add in the www folder we created earlier.</p>
<pre><code>sudo vim /etc/Nginx/sites-available/default
</code></pre><p>Look for the &ldquo;root&rdquo; and change the default to our www folder:</p>
<p><img src="/images/raspberry-pi-4-dev-server/raspberry-pi-4-dev-server-8.jpg" alt="Raspberry Pi 4 Development Server"></p>
<p>Then save the file and reload Nginx.</p>
<pre><code>sudo systemctl reload Nginx
</code></pre><p>Now you&rsquo;re serving files from the www folder instead of git. This is where we publish files after committing.</p>
<p><img src="/images/raspberry-pi-4-dev-server/raspberry-pi-4-dev-server-9.jpg" alt="Raspberry Pi 4 Development Server"></p>
<p>Let&rsquo;s go back to our developer machine.</p>
<h3 id="5-set-up-our-react-project">5. Set up Our React Project</h3>
<p><strong>Location: On Your Developer Machine</strong></p>
<p>We will build a React project and deploy that to our Pi. So let&rsquo;s set that up.</p>
<p>First, we&rsquo;ll remove the repo we cloned earlier.</p>
<pre><code>rm -rf react-hello-world/
</code></pre><p>And we&rsquo;ll use the React CLI to create an app with the same name.</p>
<pre><code>npx create-react-app react-hello-world
</code></pre><p><img src="/images/raspberry-pi-4-dev-server/raspberry-pi-4-dev-server-10.jpg" alt="Raspberry Pi 4 Development Server"></p>
<p>Now we&rsquo;ve created a basic React project. Next, initialize it as a git repository.</p>
<pre><code>git init
</code></pre><p>We&rsquo;ll add our existing files and commit them.</p>
<pre><code>git add .
git commit -m &quot;Our first commit&quot;
</code></pre><p>We&rsquo;ll set the remote to our Raspberry Pi. We set this, so when we push it to remote, the files will go to our Raspberry Pi.</p>
<pre><code>git remote add origin git@[Your IP Address]:react-hello-world.git
</code></pre><p>And we&rsquo;ll push it to the Raspberry Pi:</p>
<pre><code>git push --set-upstream origin master
</code></pre><p>If you go to the Pi, you will see the repository in your react-hello-world.git folder:</p>
<p><img src="/images/raspberry-pi-4-dev-server/raspberry-pi-4-dev-server-11.jpg" alt="Raspberry Pi 4 Development Server"></p>
<p>Now that we have that set up, we must set up the Pi to build your React application.</p>
<h2 id="6-set-up-the-server-to-build">6. Set up the Server to Build</h2>
<p><strong>Location: On Raspberry Pi</strong></p>
<p>We have our git remote repository set up, and Nginx installed, but we need to tie it all together. We need to build our application.</p>
<p>We now need to install Node and NPM on the Raspberry Pi to start.</p>
<pre><code>curl -sL https://deb.nodesource.com/setup_10.x | sudo -E bash -
sudo apt install nodejs
</code></pre><p>You can verify they&rsquo;re installed by typing in:</p>
<pre><code>node --version 
npm --version
</code></pre><p><!-- raw HTML omitted --></p>
<p><img src="/images/raspberry-pi-4-dev-server/raspberry-pi-4-dev-server-12.jpg" alt="Raspberry Pi 4 Development Server"></p>
<p>We now have Node up and running.</p>
<h3 id="7-setup-react-to-build">7. Setup React to Build</h3>
<p><strong>Location: On Raspberry Pi</strong></p>
<p>Let&rsquo;s build our React App on the Raspberry Pi, just to test it out.</p>
<p>Check out the repo locally:</p>
<pre><code>cd ~ &amp;&amp; git clone react-hello-world.git/ test
</code></pre><p>Then we will install react and react-scripts (-g makes it global)</p>
<pre><code>npm install react -g
npm install react-scripts -g
</code></pre><p>If we run:</p>
<pre><code>npm run-scripts build
</code></pre><p>We can see it built properly.</p>
<p><img src="/images/raspberry-pi-4-dev-server/raspberry-pi-4-dev-server-13.jpg" alt="Raspberry Pi 4 Development Server"></p>
<p>Once we know we can build the React app manually, we can automate it.</p>
<h3 id="8-tying-it-all-together">8. Tying It All Together</h3>
<p><strong>Location: On Raspberry Pi</strong></p>
<p>Now we need to copy those files into our www folder. We want to do that automatically every time we push to the git repo.</p>
<p>Make sure you&rsquo;re in your git remote folder on the Raspberry Pi(for me it&rsquo;s /home/git/react-hello-world.git/)</p>
<p>And create a new file:</p>
<pre><code>vim hooks/post-receive
</code></pre><p>Add in:</p>
<pre><code>#!/bin/bash
unset GIT_INDEX_FILE
echo &quot;Publishing our React App&quot;
git --work-tree /home/git/build --git-dir=/home/git/react-hello-world.git checkout -f
cd /home/git/build
npm run-script build
cp -r /home/git/build/build/* /home/git/www
</code></pre><p>Use your own folder names for this. I have created a /home/git/build folder, and its job is to hold the source files and build them.</p>
<p>What this file does is create a post-receive hook in git, so after you push to remote, these actions will be run.</p>
<ul>
<li>It checks out the repo into the build folder</li>
<li>Runs a build script</li>
<li>copies the artifacts to our www folder.</li>
</ul>
<p>There are a few different ways you can do this, but this is a simple way to build and push the application to the www folder.</p>
<p>You could build the application locally and just commit/push artifacts. I am building it on the &ldquo;server&rdquo; (our Raspberry Pi). This is a better way to do it because you can match your Raspberry Pi to your production server and only push over source to be automatically built. You don&rsquo;t have to worry about a config change on your development machine that won&rsquo;t be on your production machine. This enforces some consistency.</p>
<p>You can also run tests here if you&rsquo;d like.</p>
<p>Once you&rsquo;re done adding in these changes, then mark the file as executable.</p>
<pre><code>chmod +x hooks/post-receive
</code></pre><h3 id="9-testing-your-integration">9. Testing Your Integration</h3>
<p><strong>Location: Your local machine and the Raspberry Pi</strong></p>
<p>Now it&rsquo;s time to test it all. In your React app, open up App.js and make some kind of change.</p>
<p>Add it and commit it.</p>
<pre><code>git add .
git commit &quot;small change&quot;
git push origin master
</code></pre><p>You will see output from your remote:</p>
<p><img src="/images/raspberry-pi-4-dev-server/raspberry-pi-4-dev-server-14.jpg" alt="Raspberry Pi 4 Development Server"></p>
<p>Now you&rsquo;re ready to test it in a web browser!!!</p>
<p>Here&rsquo;s what we&rsquo;ve been waiting for!</p>
<p><img src="/images/raspberry-pi-4-dev-server/raspberry-pi-4-dev-server-15.jpg" alt="Raspberry Pi 4 Development Server"></p>
<p>There&rsquo;s my React site in all its glory.</p>
<p>Now, I can update this application by:</p>
<ul>
<li>Making changes</li>
<li>Committing</li>
<li>Pushing to Master</li>
</ul>
<p>All in a matter of seconds, I can see the results of my changes. Easy and simple. You could easily extend this, so you push it to here, do a spot check then push it to a staging or production server. The possibilities are endless.</p>
<h3 id="10-start-developing">10. Start Developing!</h3>
<p>I created this tutorial with a React app as an example, but it could just as easily be Angular, Vue, Golang, Python, PHP, or whatever. The concepts are the same. I hope this will speed up your workflow and give you a nice place to spot check and test your application before pushing it live.</p>
<p>It&rsquo;s not exactly an enterprise solution, but it&rsquo;s a cheap alternative to an actual server.</p>
<p>Here&rsquo;s how I have it setup:</p>
<p><img src="/images/raspberry-pi-4-dev-server/raspberry-pi-4-dev-server-16.jpg" alt="Raspberry Pi 4 Development Server"></p>
<p>I used my <a href="https://www.jeremymorgan.com/blog/linux/pine64-pro-laptop-review/">Pinebook Pro</a> as a development machine for this article. What you&rsquo;re looking at here is a fully capable development setup for ~$300. I could easily develop tons of apps and push them to production with this setup. Thanks to ARM processors and the tireless work of innovators such as the <a href="http://bit.ly/PiFoundation">Raspberry Pi Foundation</a> and the <a href="http://bit.ly/Pine64Project">Pine64 Project</a>.</p>
<p>What do you think? <a href="http://bit.ly/JeremyCMorgan">Yell at me on Twitter</a> and let me know!</p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
